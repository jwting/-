webpackJsonp([8],{VeOn:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s={name:"management",data:function(){return{repData:{id:window.localStorage.id,value:"",type:0,rows:10,pageNumber:1},nubEmployee:"",searchList:[{value:0,lable:"全部"},{value:1,lable:"员工姓名"},{lable:"部门",value:2},{value:3,lable:"账号"}],statusData:[{value:0,lable:"正常"},{value:1,lable:"被注销"}],mergedEmployees:{id:"",aimsId:"",clue:!1,submarine:!1},roleList:{},isMergedEmployees:!1,isUpdata:!1,searchData:{cId:"",type:"userName",value:""},pageValue:"",isPermissionsList:!1,pushEmployee:{id:"",userName:"",nickName:"",password:"",dId:"",role:{id:""}},pushDepartment:{deptName:"",aId:window.localStorage.id,id:""},departmentList:{data:[]},departmentEmployee:{},employeeList:{},editList:[]}},watch:{$route:function(e,t){this.pageValue=this.$route.params.value,this.getpageValue(this.pageValue)},nubEmployee:function(){var e=this;console.log(this.nubEmployee),e.axios({url:this.host+"user/searchDeptEmployee",method:"post",data:{id:this.nubEmployee}}).then(function(t){e.departmentEmployee=t.data})}},components:{Action_tit:a("mMS5").a},methods:{deleteDepartment:function(e,t){var a=this,s=this;this.$confirm("此操作将删除此部门, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){a.axios({method:"post",data:{id:e},url:a.host+"dept/del"}).then(function(e){200==e.data.status?(s.departmentList.data.splice(t,1),s.$message({message:e.data.msg,type:"success"})):s.$message.error(e.data.msg)})}).catch(function(){a.$message({type:"info",message:"已取消"})})},selectChange:function(e,t){var a=this;this.axios({method:"post",data:{id:t,status:e},url:this.host+"user/cancellation"}).then(function(e){200==e.data.status?(a.getEmployeeList(),a.$message({message:e.data.msg,type:"success"})):a.$message.error(e.data.msg)})},pushMergedEmployees:function(){var e=this;this.axios({method:"post",data:this.mergedEmployees,url:this.host+"user/mergeEmployee"}).then(function(t){200==t.data.status?(e.getEmployeeList(),e.isMergedEmployees=!1,e.$message({message:t.data.msg,type:"success"})):e.$message.error(t.data.msg)})},updataXin:function(e){var t=this;this.isUpdata=!0,this.axios({method:"post",data:{id:e.id},url:this.host+"user/getUserDeatils"}).then(function(a){t.pushEmployee={id:e.id,nickName:a.data.data.nickName,userName:a.data.data.userName,password:a.data.data.password,dId:a.data.data.dId,role:{id:a.data.data.role.id}},t.isPermissionsList=!0})},deleteList:function(){var e=this;this.$confirm("此操作将删除或注销记录, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){console.log("dad")}).catch(function(){e.$message({type:"info",message:"已取消"})})},toSearch:function(){this.repData.pageNumber=1,this.getEmployeeList()},updataSionsList:function(){var e=this;if(this.isUpdata&&1==this.pageValue)var t=this.pushDepartment,a="dept/update";else if(this.isUpdata||1!=this.pageValue)if(this.isUpdata||0!=this.pageValue){if(this.isUpdata&&0==this.pageValue)t=this.pushEmployee,a="user/updateStaff"}else t=this.pushEmployee,a="user/addStaff";else var t={aId:this.pushDepartment.aId,deptName:this.pushDepartment.deptName},a="dept/createDept";this.axios({method:"post",data:t,url:this.host+a}).then(function(t){e.isPermissionsList=!1,200==t.data.status?(1==e.pageValue?e.getDepartmentList():0==e.pageValue&&e.getEmployeeList(),e.$message({message:t.data.msg,type:"success"})):e.$message.error(t.data.msg)})},handleSelectionChange:function(e){this.editList=e},handleSizeChange:function(e){this.repData.rows=e,this.getEmployeeList()},handleCurrentChange:function(e){this.repData.pageNumber=e,this.getEmployeeList()},getEmployeeList:function(){var e=this;this.axios({method:"POST",data:this.repData,url:this.host+"user/searchEmployee"}).then(function(t){e.employeeList=t.data})},getDepartmentList:function(){var e=this;this.axios({method:"POST",data:{id:window.localStorage.cId},url:this.host+"dept/searchDeptDeatil"}).then(function(t){e.departmentList=t.data})},getpageValue:function(e){1==e?this.getDepartmentList():0==e&&(this.getEmployeeList(),this.getDepartmentList(),this.getRoleList())},getRoleList:function(){var e=this;this.axios({method:"POST",data:{cId:window.localStorage.cId},url:this.host+"permission/getCompanyRoles"}).then(function(t){e.roleList=t.data})}},created:function(){this.pageValue=this.$route.params.value,this.getpageValue(this.pageValue)}},l={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"action_child",staticStyle:{"padding-bottom":"100px"}},[a("action_tit",{attrs:{title:1==e.pageValue?"部门管理":"员工管理"}}),e._v(" "),a("div",{staticStyle:{"margin-bottom":"5px"}},[a("el-button",{attrs:{type:"primary",icon:"el-icon-plus"},on:{click:function(t){e.isPermissionsList=!0,e.isUpdata=!1}}},[e._v(e._s(1==e.pageValue?"添加部门":"添加员工"))]),e._v(" "),0==e.pageValue?a("el-select",{staticStyle:{width:"150px","margin-left":"20px"},attrs:{placeholder:"选择搜索条件"},model:{value:e.repData.type,callback:function(t){e.$set(e.repData,"type",t)},expression:"repData.type"}},e._l(e.searchList,function(e){return a("el-option",{key:e.value,attrs:{label:e.lable,value:e.value}})})):e._e(),e._v(" "),0==e.pageValue?a("el-input",{staticClass:"input-with-select",attrs:{placeholder:"请输入搜索内容"},on:{clikc:e.toSearch},model:{value:e.repData.value,callback:function(t){e.$set(e.repData,"value",t)},expression:"repData.value"}},[a("el-button",{staticStyle:{width:"50px",padding:"0"},attrs:{slot:"append",icon:"el-icon-search"},on:{click:e.toSearch},slot:"append"})],1):e._e(),e._v(" "),1==e.pageValue?a("span",[e._v("     一共 "),a("span",{staticClass:"danger",staticStyle:{"font-weight":"600"}},[e._v(e._s(e.departmentList?e.departmentList.data.length:0))]),e._v(" 条记录")]):e._e(),e._v(" "),0==e.pageValue?a("span",[e._v("     一共 "),a("span",{staticClass:"danger",staticStyle:{"font-weight":"600"}},[e._v(e._s(e.employeeList.countSum))]),e._v(" 条记录")]):e._e()],1),e._v(" "),0==e.pageValue?a("div",[a("span",{staticClass:"ti",staticStyle:{"margin-left":"0","margin-bottom":"20px"}},[e._v("\n        温馨提示！\n        员工账号被注销后，可通过更改状态恢复。合并账号未被选择的被合并账号线索，进入公司线索池\n      ")])]):e._e(),e._v(" "),1==e.pageValue?a("div",[a("span",{staticClass:"ti",staticStyle:{"margin-left":"0","margin-bottom":"20px"}},[e._v("\n          温馨提示！\n          删除部门需要先移除该部门下所有员工\n        ")])]):e._e(),e._v(" "),a("el-dialog",{staticStyle:{"text-align":"left","font-size":"12px","border-radius":"6px"},attrs:{visible:e.isPermissionsList,width:"400px",center:!0},on:{"update:visible":function(t){e.isPermissionsList=t}}},[0==e.pageValue?a("div",[a("el-row",{staticClass:"lin"},[a("el-col",{attrs:{span:5}},[a("span",{staticClass:"danger"},[e._v("*")]),a("span",[e._v("员工姓名:")])]),e._v(" "),a("el-col",{attrs:{span:19}},[a("el-input",{model:{value:e.pushEmployee.nickName,callback:function(t){e.$set(e.pushEmployee,"nickName",t)},expression:"pushEmployee.nickName"}})],1)],1),e._v(" "),a("el-row",{staticClass:"lin"},[a("el-col",{attrs:{span:5}},[a("span",{staticClass:"danger"},[e._v("*")]),a("span",[e._v("用户名:")])]),e._v(" "),a("el-col",{attrs:{span:19}},[a("el-input",{model:{value:e.pushEmployee.userName,callback:function(t){e.$set(e.pushEmployee,"userName",t)},expression:"pushEmployee.userName"}})],1)],1),e._v(" "),a("el-row",{staticClass:"lin"},[a("el-col",{attrs:{span:5}},[a("span",{staticClass:"danger"},[e._v("*")]),a("span",[e._v("密码:")])]),e._v(" "),a("el-col",{attrs:{span:19}},[a("el-input",{attrs:{type:"password"},model:{value:e.pushEmployee.password,callback:function(t){e.$set(e.pushEmployee,"password",t)},expression:"pushEmployee.password"}})],1)],1),e._v(" "),a("el-row",{staticClass:"lin"},[a("el-col",{attrs:{span:5}},[a("span",{staticClass:"danger"},[e._v("*")]),a("span",[e._v("部门:")])]),e._v(" "),a("el-col",{attrs:{span:19}},[a("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择部门"},model:{value:e.pushEmployee.dId,callback:function(t){e.$set(e.pushEmployee,"dId",t)},expression:"pushEmployee.dId"}},e._l(e.departmentList.data,function(e){return a("el-option",{key:e.id,attrs:{label:e.deptName,value:e.id}})}))],1)],1),e._v(" "),"2"!=e.pushEmployee.role.id?a("el-row",{staticClass:"lin"},[a("el-col",{attrs:{span:5}},[a("span",{staticClass:"danger"},[e._v("*")]),a("span",[e._v("角色:")])]),e._v(" "),a("el-col",{attrs:{span:19}},[a("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择角色"},model:{value:e.pushEmployee.role.id,callback:function(t){e.$set(e.pushEmployee.role,"id",t)},expression:"pushEmployee.role.id"}},e._l(e.roleList.data,function(e){return a("el-option",{key:e.id,attrs:{label:e.roleName,value:e.id}})}))],1)],1):e._e()],1):e._e(),e._v(" "),1==e.pageValue?a("div",[a("el-row",{staticClass:"lin"},[a("el-col",{attrs:{span:5}},[a("span",{staticClass:"danger"},[e._v("*")]),a("span",[e._v("部门名称:")])]),e._v(" "),a("el-col",{attrs:{span:19}},[a("el-input",{model:{value:e.pushDepartment.deptName,callback:function(t){e.$set(e.pushDepartment,"deptName",t)},expression:"pushDepartment.deptName"}})],1)],1)],1):e._e(),e._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.isPermissionsList=!1}}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:e.updataSionsList}},[e._v("确 定")])],1)]),e._v(" "),0==e.pageValue?a("el-dialog",{staticStyle:{"text-align":"left","font-size":"12px","border-radius":"6px"},attrs:{visible:e.isMergedEmployees,width:"400px",center:!0},on:{"update:visible":function(t){e.isMergedEmployees=t}}},[a("div",[a("el-row",{staticClass:"lin"},[a("el-col",{attrs:{span:6}},[a("span",{staticClass:"danger"},[e._v("*")]),a("span",[e._v("合并员工:")])]),e._v(" "),a("el-col",{attrs:{span:18}},[a("el-input",{model:{value:e.mergedEmployees.nickName,callback:function(t){e.$set(e.mergedEmployees,"nickName",t)},expression:"mergedEmployees.nickName"}})],1)],1),e._v(" "),a("el-row",{staticClass:"lin"},[a("el-col",{attrs:{span:6}},[a("span",{staticClass:"danger"},[e._v("*")]),a("span",[e._v("被合并员工:")])]),e._v(" "),a("el-col",{attrs:{span:8}},[a("el-select",{staticStyle:{width:"90%"},attrs:{placeholder:"请选择部门"},model:{value:e.nubEmployee,callback:function(t){e.nubEmployee=t},expression:"nubEmployee"}},e._l(e.departmentList.data,function(e){return a("el-option",{key:e.id,attrs:{label:e.deptName,value:e.id}})}))],1),e._v(" "),a("el-col",{attrs:{span:10}},[a("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择员工"},model:{value:e.mergedEmployees.aimsId,callback:function(t){e.$set(e.mergedEmployees,"aimsId",t)},expression:"mergedEmployees.aimsId"}},e._l(e.departmentEmployee.data,function(t){return a("el-option",{key:t.id,attrs:{disabled:t.id==e.mergedEmployees.id,label:t.nickName,value:t.id}})}))],1)],1),e._v(" "),a("el-row",{staticClass:"lin"},[a("el-col",{attrs:{span:6}},[a("span",{staticClass:"danger"},[e._v("*")]),a("span",[e._v("选择:")])]),e._v(" "),a("el-col",{attrs:{span:18}},[a("el-checkbox",{attrs:{label:"潜客"},model:{value:e.mergedEmployees.submarine,callback:function(t){e.$set(e.mergedEmployees,"submarine",t)},expression:"mergedEmployees.submarine"}}),e._v(" "),a("el-checkbox",{attrs:{label:"线索"},model:{value:e.mergedEmployees.clue,callback:function(t){e.$set(e.mergedEmployees,"clue",t)},expression:"mergedEmployees.clue"}})],1)],1)],1),e._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.isMergedEmployees=!1}}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:e.pushMergedEmployees}},[e._v("确 定")])],1)]):e._e(),e._v(" "),0==e.pageValue?a("el-table",{key:"111155",staticStyle:{width:"100%",margin:"0 auto"},attrs:{data:e.employeeList.data,border:""}},[a("el-table-column",{attrs:{prop:"nickName",label:"员工名称",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"deptName",align:"center",label:"部门"}}),e._v(" "),a("el-table-column",{attrs:{prop:"userName",label:"手机账号",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"roleName",align:"center",label:"角色"}}),e._v(" "),a("el-table-column",{attrs:{align:"center",label:"最后登录时间"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(e.timestampToTime(t.row.loginTime)))])]}}])}),e._v(" "),a("el-table-column",{attrs:{align:"center",label:"状态"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-select",{staticStyle:{width:"80%"},attrs:{placeholder:"请选择转态"},on:{change:function(a){e.selectChange(t.row.status,t.row.id)}},model:{value:t.row.status,callback:function(a){e.$set(t.row,"status",a)},expression:"scope.row.status"}},e._l(e.statusData,function(t){return a("el-option",{key:t.value,attrs:{disabled:t.id==e.mergedEmployees.id,label:t.lable,value:t.value}})}))]}}])}),e._v(" "),a("el-table-column",{attrs:{align:"center",label:"线索池数量"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("router-link",{staticClass:"color",attrs:{to:{name:"myClue",query:{value:t.row.id,radio:"queryCues"}}}},[e._v("\n            "+e._s(t.row.clueCount)+"\n          ")])]}}])}),e._v(" "),a("el-table-column",{attrs:{align:"center",label:"潜客池数量"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("router-link",{staticClass:"color",attrs:{to:{name:"myClue",query:{value:t.row.id,radio:"querySubmersible"}}}},[e._v("\n            "+e._s(t.row.submarineCount)+"\n          ")])]}}])}),e._v(" "),a("el-table-column",{attrs:{align:"center",label:"设置"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"text"},on:{click:function(a){e.updataXin(t.row)}}},[e._v("编辑")]),e._v(" "),a("el-button",{staticStyle:{color:"#F56C6C"},attrs:{type:"text"},on:{click:function(a){e.isMergedEmployees=!0,e.mergedEmployees.id=t.row.id,e.mergedEmployees.nickName=t.row.nickName}}},[e._v("\n                     合并\n          ")])]}}])})],1):e._e(),e._v(" "),1==e.pageValue?a("el-table",{key:"1111544",staticStyle:{width:"100%",margin:"0 auto"},attrs:{data:e.departmentList.data,border:""}},[a("el-table-column",{attrs:{prop:"deptName",label:"部门名称",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{align:"center",label:"部门经理"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(t.row.deptManagerName?t.row.deptManagerName:"/"))])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"线索池数量",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("router-link",{staticClass:"color",attrs:{to:{name:"departmentalClues",query:{value:t.row.id,radio:"queryCues"}}}},[e._v("\n            "+e._s(t.row.clueCount?t.row.clueCount:"0")+"\n          ")])]}}])}),e._v(" "),a("el-table-column",{attrs:{label:"潜客池数量",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("router-link",{staticClass:"color",attrs:{to:{name:"departmentalClues",query:{value:t.row.id,radio:"querySubmersible"}}}},[e._v("\n            "+e._s(t.row.submarineCount?t.row.submarineCount:"0")+"\n          ")])]}}])}),e._v(" "),a("el-table-column",{attrs:{align:"center",label:"员工数量"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(t.row.staffCount?t.row.staffCount:"/"))])]}}])}),e._v(" "),a("el-table-column",{attrs:{align:"center",label:"设置"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"text"},on:{click:function(a){e.isPermissionsList=!0,e.isUpdata=!0,e.pushDepartment.id=t.row.id,e.pushDepartment.deptName=t.row.deptName}}},[e._v("编辑")])]}}])})],1):e._e(),e._v(" "),0==e.pageValue?a("div",{staticStyle:{width:"60%",float:"right"}},[e.employeeList.countSum>10?a("el-pagination",{staticStyle:{"text-align":"right","margin-top":"20px"},attrs:{background:!0,"page-sizes":[10,20,50,100],"current-page":e.repData.pageNumber,"page-size":e.repData.rows,"pager-count":7,layout:"total, sizes, prev, pager, next, jumper",total:e.employeeList.countSum},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange,"update:currentPage":function(t){e.$set(e.repData,"pageNumber",t)}}}):e._e()],1):e._e()],1)},staticRenderFns:[]};var n=a("VU/8")(s,l,!1,function(e){a("dqEj")},"data-v-8a177a7e",null);t.default=n.exports},dqEj:function(e,t){}});